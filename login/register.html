<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - Internet Shop</title>
    <link rel="stylesheet" href="../index.css">
      <link rel="stylesheet" href="register.css">
    <link rel="stylesheet" href="../header/header.css">
    
</head>
<body>
    <button id="scrollToTopBtn" title="До верху">↑</button>

    <div id="header">
        <div class="logo">
            <img src="" alt="">
        </div>
        <div class="products">
            <span><a href="../index.html">Products </a></span>
        </div>
        <div class="news">
            <span><a href="../news/news.html">News</a></span>
        </div>
        <div class="log-in"><span><a href="login.html">Log in</a></span></div>
        <div class="cart">
            <a href="../cart/cart.html">
                <img src="../img/—Pngtree—shopping cart convenient icon_4637407.png" alt="Cart Icon">
            </a>
            <span id="cart-count">0</span> 
        </div>
    </div>

    <div class="register-container">
        <h2>Реєстрація</h2>
        <div id="alert-container"></div>
        <form id="register-form">
            <div class="input-group">
                <label for="username">Логін</label>
                <input type="text" id="username" name="username" placeholder="Введіть бажаний логін" required>
            </div>
            <div class="input-group">
                <label for="password">Пароль</label>
                <input type="password" id="password" name="password" placeholder="Введіть пароль" required>
            </div>
            <div class="input-group">
                <label for="confirm-password">Підтвердження пароля</label>
                <input type="password" id="confirm-password" name="confirm-password" placeholder="Підтвердіть пароль" required>
            </div>
            <div class="role-selector">
                <label for="role">Роль</label>
                <select id="role" name="role" class="form-control">
                    <option value="user">Користувач</option>
                    <option value="admin">Адміністратор</option>
                </select>
            </div>
            <button type="submit" class="register-btn">Зареєструватися</button>
        </form>
        <div class="login-link">
            Вже маєте акаунт? <a href="login.html">Увійти</a>
        </div>
    </div>

    <script>
   // Modify the fetch request in your registration form submission handler
document.getElementById('register-form').addEventListener('submit', async function(event) {
    event.preventDefault();
    
    const usernameInput = this.username.value.trim();
    const passwordInput = this.password.value.trim();
    const confirmPasswordInput = document.getElementById('confirm-password').value.trim();
    const roleInput = this.role.value;
    
    clearValidationErrors();
    
    let isValid = true;
    
    // Validation logic remains the same...
    
    if (!isValid) return;
    
    const submitButton = this.querySelector('button[type="submit"]');
    submitButton.disabled = true;
    submitButton.textContent = 'Зачекайте...';
    
    // Original URL
    const originalUrl = 'https://chnu-student-interview-preparation.netlify.app/.netlify/functions/userRegister';
    
    // Using a CORS proxy (for testing only)
    const corsProxyUrl = 'https://cors-anywhere.herokuapp.com/';
    const url = corsProxyUrl + originalUrl;
    
    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: { 
                'Content-Type': 'application/json',
                'X-Requested-With': 'XMLHttpRequest' // Required by some CORS proxies
            },
            body: JSON.stringify({
                username: usernameInput,
                password: passwordInput,
                role: roleInput
            }),
        });
        
        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.message || 'Помилка реєстрації');
        }
        
        showAlert('Реєстрація успішна! Тепер ви можете увійти в систему.', 'success');
        
        // Redirect after short delay
        setTimeout(() => {
            window.location.href = 'login.html';
        }, 2000);
        
    } catch (error) {
        showAlert(error.message, 'danger');
    } finally {
        submitButton.disabled = false;
        submitButton.textContent = 'Зареєструватися';
    }
});
    </script>
</body>
</html>
